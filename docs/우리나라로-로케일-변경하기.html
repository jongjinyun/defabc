<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>repo 4 우리나라로 로케일 변경하기 | Rrepo</title>
  <meta name="description" content="repo 4 우리나라로 로케일 변경하기 | Rrepo" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="repo 4 우리나라로 로케일 변경하기 | Rrepo" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="repo 4 우리나라로 로케일 변경하기 | Rrepo" />
  
  
  

<meta name="author" content="defabc" />


<meta name="date" content="2022-03-11" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="미국-로케일로-로케일을-변환하기.html"/>

<script src="libs/header-attrs-2.13/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>




<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">defabc</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> defabc<span></span></a></li>
<li class="chapter" data-level="2" data-path="setting.html"><a href="setting.html"><i class="fa fa-check"></i><b>2</b> setting<span></span></a>
<ul>
<li class="chapter" data-level="2.1" data-path="setting.html"><a href="setting.html#window"><i class="fa fa-check"></i><b>2.1</b> window<span></span></a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="setting.html"><a href="setting.html#설치해야할-프로그램"><i class="fa fa-check"></i><b>2.1.1</b> 설치해야할 프로그램<span></span></a></li>
<li class="chapter" data-level="2.1.2" data-path="setting.html"><a href="setting.html#rtools설치"><i class="fa fa-check"></i><b>2.1.2</b> Rtools설치<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="setting.html"><a href="setting.html#window-영어-설정"><i class="fa fa-check"></i><b>2.2</b> window 영어 설정<span></span></a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="setting.html"><a href="setting.html#locale-encoding의-이해"><i class="fa fa-check"></i><b>2.2.1</b> locale encoding의 이해<span></span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="미국-로케일로-로케일을-변환하기.html"><a href="미국-로케일로-로케일을-변환하기.html"><i class="fa fa-check"></i><b>3</b> 미국 로케일로 로케일을 변환하기<span></span></a></li>
<li class="chapter" data-level="4" data-path="우리나라로-로케일-변경하기.html"><a href="우리나라로-로케일-변경하기.html"><i class="fa fa-check"></i><b>4</b> 우리나라로 로케일 변경하기<span></span></a>
<ul>
<li class="chapter" data-level="4.0.1" data-path="우리나라로-로케일-변경하기.html"><a href="우리나라로-로케일-변경하기.html#dbplyr"><i class="fa fa-check"></i><b>4.0.1</b> dbplyr<span></span></a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Rrepo</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="우리나라로-로케일-변경하기" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">repo 4</span> 우리나라로 로케일 변경하기<a href="우리나라로-로케일-변경하기.html#우리나라로-로케일-변경하기" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Sys.setlocale(category = ‘LC_ALL’,locale=‘korean’)
localeToCharset()</p>
<pre><code>
### miniconda 설치
- [슬기로운통계생활 - 유투브](https://www.youtube.com/watch?v=DFN__fmPvmI&amp;t=937s)
- google: git and install miniconda 검색
- 설치과정에 &#39;Select the first option for “Add Anaconda to my PATH environment variable” and also leave the selection on “Register Anaconda as my default Python 3.7”. Click on “Install”.&#39; 체크

### miniconda 가상환경 생성
- cmd: conda</code></pre>
<p>conda –version
conda update –all</p>
<pre><code>
- 가상환경</code></pre>
<p>conda env list
conda create -n ‘nm’
conda create -n ‘nm’ python=3.6
codna env remove -n ‘nm’
conda list
conda activate ‘nm’
conda deactivate
conda install ‘package_nm’</p>
<pre><code>
### R에서 Python 사용하기
- [슬기로운통계생활 - 유투브](https://www.youtube.com/watch?v=krDkfOCLsA4)
- reticulate package 설치</code></pre>
<p>install.packages(‘reticulate’)</p>
<pre><code>- miniconda에 설치된 가상환경 연결 및 확인</code></pre>
<p>reticulate::use_condaenv(“url”)
reticulate::py_config()
reticulate::py_discover_config()</p>
<pre><code>- 가상환경 주소 확인
    - cmd 내 가상환경 activate
    - conda list
        - package가 설치된 환경 주소 나옴


### git 연결 오류(port 22)
- 윈도우에서 git 설정한 후 Rstudio와 연결시 오류 발생</code></pre>
<p>ssh: connect to host github.com port 22: Operation timed out
fatal: Could not read from remote repository.</p>
<pre><code>Please make sure you have the correct access rights
and the repository exists.</code></pre>
<pre><code>- 이유는 방화벽이나 ISP가 설정한 방화벽이 port22에서 ssh연결을 차단하는 경우 [출처](https://velog.io/@resident000/ssh-%EC%A0%91%EC%86%8D-%EC%8B%9C-port-22-blocked-%EB%AC%B8%EC%A0%9C)
- 해결방법은 \~/ssh/config에 아래 내용을 추가</code></pre>
<p>Host github.com
Hostname ssh.github.com
Port 443</p>
<pre><code>- 이때, config파일이 없을 경우 만들어야함
    - 파워쉘이나 CMD에서 vim 명령어는 먹히지 않음
- Git Bash를 실행해 config 생성 [출처](https://dev-coco.tistory.com/107)
    - 마우스 오른쪽 클릭 Git Bash Here
    - 디렉토리 생성(mkdir)</code></pre>
<p>mkdir ~/.ssh</p>
<pre><code>    - config 파일 생성</code></pre>
<p>vim ~/.ssh/config</p>
<pre><code>    - config 아래 호스트 정보 등록
      - i를 눌러 입력하고 esc
      - :wq 명령어로 저장 및 종료

### rmarkdown - pdf 및 한글사용을 위한 설정
- tinytex 설치 [슬기로운통계생활 - 유투브](https://www.youtube.com/watch?v=WMzUq9PyNIQ&amp;t=996s)</code></pre>
<p>install.packages(“tinytex”)
tinytex::install_tinytex()</p>
<pre><code>
- 아래 순서와 같이 진행
    - use_tinytex()를 실행 한 후 tlmgr파일이 있는 tinytex 폴더로 경로 설정
    - tlmgr의 위치: User/name/AppData/Roaming/ (tlmgr 한번 실행할 것)</code></pre>
<p>tinytex::use_tinytex()
tinytex::tinytex_root()</p>
<pre><code>- yml에 다음 내용 추가</code></pre>
<p>output: pdf_document
header-includes:
- </p>
<pre><code>- [KTUG한글TEX사용자그룹](http://www.ktug.org/xe/)-내려받기-Microsoft Windows용 설치방법
    - TeXLive windows에 설치하기의 4. ko.TeXLive 설정
    - 아래 내용 cmd에서 실행 </code></pre>
<blockquote>
<p>tlmgr repository add <a href="https://cran.asia/KTUG/texlive/tlnet" class="uri">https://cran.asia/KTUG/texlive/tlnet</a> ktug
tlmgr pinning add ktug *
tlmgr install ktugbin
tlmgr install texworks-config
tlmgr install nanumttf hcr-lvt</p>
</blockquote>
<pre><code>
### Visual Studio code 테마 설정
- 설치방법 [슬기로운통계생활 - 유투브](https://www.youtube.com/watch?v=oXBTqqBOa_k)
- google: rstudio vscode theme
  - [rscodeio](https://github.com/anthonynorth/rscodeio)</code></pre>
<p>install.packages(“remotes”)
remotes::install_github(“anthonynorth/rscodeio”)
rscodeio::install_theme()</p>
<pre><code>
### 네이버 - D2=Coding
- [D2 coding 글꼴](https://github.com/naver/d2codingfont)

&lt;!--chapter:end:02-setting.Rmd--&gt;

# R tips
## Affinity Designer for SVGLITE
Affiinity Designer 사용을 위한 svglite package의 code 수정방법에 대해 알아본다.

Affiinity Designer는 Adobe사의 Illustrator와 같은 벡터드로잉프로그램이다. Serif는 Affiinity 프로그램에 대해 1회 구매시 특정 버전 이하에 대해서는 기간에 관계 없이 이용할 수 있도록 하여 Adobe 제품과 비교해 더 경제적인 장점이 있다. 필자는 R에서 ggplot2를 이용해 작성된 그래프를 수정하기 위해 이 프로그램을 사용하고 있다.

ggplot2에서는 svg 등 벡터 이미지파일을 내보내기 위해 svglite package를 사용한다. 그러나 Affiinity Designer는 svglite로 내보내진 벡터이미지파일을 정확하게 읽지 못한다. Angelo Limeta는 이 문제의 원인을 기술하고, 해결하는 [방법](https://github.com/angelolimeta/svgliteForAffinity)을 제안했다. 그러나 Angelo Limeta는 svglite 1.2.2에 한정해 문제를 해결해, 2021년 기준 2.0.0버전인 svglite에서는 문제를 해결할 수 없다. 이 페이지에서는 최신 버전의 svglite에서 어떻게 문제를 해결하는지 기술한다.

### code 수정

svglite는 multiple CSS style과 CDATA sections 다루지 못한다. ggplot2는 svglite의 svglite함수를 이용하는데, 이 함수는 C++로 구성된 &#39;devSVG.cpp&#39;를 이용한다. 따라서 &#39;devSVG.cpp&#39; 내 code를 일부 코드를 수정해 문제를 해결한다.

CRAN에 등록된 svglite 가운데 package sources &#39;svglite 2.0.0.tar.gz&#39;를 다운받고, 압축을 해제하면, src파일에 &#39;devSVG.cpp&#39;파일이 있다. windows binaries 또는 mac os binaries를 통해 설치된 파일에서는 code를 수정 할 수 없다.

아래 a의 //Setting default styles의 code를, b의 //Setting default styles로 바꾼후 저장한다. 이때, devSVG.cpp 파일은 메모장을 이용해 읽을 수 있다.

a code</code></pre>
…
// Setting default styles
(<em>stream) &lt;&lt; “<defs>”;
(</em>stream) &lt;&lt; ”
<style type='text/css'><![CDATA[\n";
  (*stream) << "    line, polyline, path, rect, circle {\n";
  (*stream) << "      fill: none;\n";
  (*stream) << "      stroke: #000000;\n";
  (*stream) << "      stroke-linecap: round;\n";
  (*stream) << "      stroke-linejoin: round;\n";
  (*stream) << "      stroke-miterlimit: 10.00;\n";
  (*stream) << "    }\n";
  (*stream) << "  ]]></style>
<p>“;
(<em>stream) &lt;&lt; ”</defs>”;
…
(</em>stream) &lt;&lt;”&lt;rect width=‘100%’ height=‘100%’“;</p>
<pre><code>
b code</code></pre>
…
// Setting default styles
(<em>stream) &lt;&lt; “<defs>”;
(</em>stream) &lt;&lt; ”
<style>\n";
  (*stream) << "    line {\n";
  (*stream) << "      fill: none;\n";
  (*stream) << "      stroke: #000000;\n";
  (*stream) << "      stroke-linecap: round;\n";
  (*stream) << "      stroke-linejoin: round;\n";
  (*stream) << "      stroke-miterlimit: 10.00;\n";
  (*stream) << "    }\n";
  (*stream) << "    polyline {\n";
  (*stream) << "      fill: none;\n";
  (*stream) << "      stroke: #000000;\n";
  (*stream) << "      stroke-linecap: round;\n";
  (*stream) << "      stroke-linejoin: round;\n";
  (*stream) << "      stroke-miterlimit: 10.00;\n";
  (*stream) << "    }\n";
  (*stream) << "    path {\n";
  (*stream) << "      fill: none;\n";
  (*stream) << "      stroke: #000000;\n";
  (*stream) << "      stroke-linecap: round;\n";
  (*stream) << "      stroke-linejoin: round;\n";
  (*stream) << "      stroke-miterlimit: 10.00;\n";
  (*stream) << "    }\n";
  (*stream) << "    rect {\n";
  (*stream) << "      fill: none;\n";
  (*stream) << "      stroke: #000000;\n";
  (*stream) << "      stroke-linecap: round;\n";
  (*stream) << "      stroke-linejoin: round;\n";
  (*stream) << "      stroke-miterlimit: 10.00;\n";
  (*stream) << "    }\n";
  (*stream) << "    circle {\n";
  (*stream) << "      fill: none;\n";
  (*stream) << "      stroke: #000000;\n";
  (*stream) << "      stroke-linecap: round;\n";
  (*stream) << "      stroke-linejoin: round;\n";
  (*stream) << "      stroke-miterlimit: 10.00;\n";
  (*stream) << "    }\n";
  (*stream) << "  </style>
<p>“;
(*stream) &lt;&lt; “</defs>”;
…</p>
<pre><code>
### 발생문제
(window) tar.gz 파일로 압축하는 방법  
반디집을 사용하였다. 먼저 반디집 내 새로압축 기능 가운데 압축형식을 tar로 설정하고 압축한다. 그 다음 tar로 압축된 파일을 다시 압충형식 gz로 설정하고 압축한다. 두 단계를 거쳐, tar.gz 파일로 압축 할 수 있다.

(window) 수동 설치가 되지 않는 문제  
tar.gz파일로 된 패키지가 R에서 수동으로 설치되지 않는 문제가 있다. 관련 내용은 [블로그](&lt;https://blog.naver.com/PostView.nhn?blogId=itisik&amp;logNo=221597983934&amp;parentCategoryNo=&amp;categoryNo=&amp;viewDate=&amp;isShowPopularPosts=false&amp;from=postView&gt;) 를 참고하였다.

설치가 되지 않는 원인은 CRAN 내 ripa package가 내려갔기 때문이다. ripa는 CRAN 내 [아카이브](https://cran.r-project.org/src/contrib/Archive/ripa/)에서 설치 할 수 있다. 그리고 ripa 설치를 위해선, Rtools가 설치되어야 한다.

(mac) m1칩을 사용하는 경우
(mac) homebrew 설치 및 libpng package 설치했음

&lt;!--chapter:end:03-tips.Rmd--&gt;

# data preprocessing
## DBI &amp; RSQLite
RAM보다 큰 대용량데이터를 다루기 위해 DBI와 RSQLite 패키지를 사용한다. RSQLite는 R에서 SQLite DB를 사용할 수 있도록 하며, SQLite는 데이터베이스 전체를 파일 하나에 저장하기 때문에 백업과 이동이 간편하다. 참고한 웹페이지는 다음과 같다.
- [R에서 DB사용(Sqlite)](https://unfinishedgod.netlify.app/2020/07/24/r%EC%97%90%EC%84%9C-db-%EC%82%AC%EC%9A%A9sqlite/)

단, 전체 DB를 가지고 데이터 전처리를 진행하지 않는걸 추천한다. 일부 sample을 가지고 데이터 전처리를 수행한 후, 한 파일로 합치는 용도로 쓴다. 이때, DB에 대한 데이터 집계처리는 필요한 테이블을 추출하는 용도로만 사용한다. 예를 들어, case_when 등 function은 dbplyr로 처리가 되지 않는다.

### DB생성
- DB의 생성은 다음과 같이 진행한다.
    - **dbConnect()**함수를 활용해 연결한다. SQLite()는 드라이버의 이름을 의미한다.</code></pre>
<p>dbConnect(SQLite(), dbname = ‘dbname’)</p>
<pre><code>    - **dbSendQuery**를 사용하여 DB의 틀을 작성한다.</code></pre>
<p>dbSendQuery(con,
“CREATE TABLE E_db (
year TEXT,
sido TEXT,
gender TEXT,
start_yr TEXT,
start_mn TEXT)”)
```
- <strong>dbListTables(con)</strong>로 테이블리스트를 확인한다.
- <strong>dbGetQuery(con, “SELECT * FROM E_db”)</strong>
- DB에 데이터를 다음과 같이 저장한다.
- <strong>dbWriteTable(con, name = “E_db”, value = db_3, row.names = F, append = T)</strong>
- value는 저장할 데이터를 의미한다.
- append=T일 경우 데이터를 아래로 붙인다.
- <strong>dbDisconnect(con)</strong>시 자동으로 저장된다.</p>
<div id="dbplyr" class="section level3 hasAnchor" number="4.0.1">
<h3><span class="header-section-number">4.0.1</span> dbplyr<a href="우리나라로-로케일-변경하기.html#dbplyr" class="anchor-section" aria-label="Anchor link to header"></a></h3>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="미국-로케일로-로케일을-변환하기.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/jongjinyun/defabc/edit/master/04-data-preprocessing.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/jongjinyun/defabc/blob/master/04-data-preprocessing.Rmd",
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
