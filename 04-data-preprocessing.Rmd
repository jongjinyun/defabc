# data preprocessing
## DBI & RSQLite
RAM보다 큰 대용량데이터를 다루기 위해 DBI와 RSQLite 패키지를 사용한다. RSQLite는 R에서 SQLite DB를 사용할 수 있도록 하며, SQLite는 데이터베이스 전체를 파일 하나에 저장하기 때문에 백업과 이동이 간편하다. 참고한 웹페이지는 다음과 같다.
- [R에서 DB사용(Sqlite)](https://unfinishedgod.netlify.app/2020/07/24/r%EC%97%90%EC%84%9C-db-%EC%82%AC%EC%9A%A9sqlite/)

단, 전체 DB를 가지고 데이터 전처리를 진행하지 않는걸 추천한다. 일부 sample을 가지고 데이터 전처리를 수행한 후, 한 파일로 합치는 용도로 쓴다. 이때, DB에 대한 데이터 집계처리는 필요한 테이블을 추출하는 용도로만 사용한다. 예를 들어, case_when 등 function은 dbplyr로 잘 처리가 되지 않으며 오래걸린다. 특히, 메모리 문제로 오류가 발생할 가능성이 있다.

### DB생성
- DB의 생성은 다음과 같이 진행한다.
    - **dbConnect()**함수를 활용해 연결한다. SQLite()는 드라이버의 이름을 의미한다.
```
dbConnect(SQLite(), dbname = 'dbname')
```
    - **dbSendQuery**를 사용하여 DB의 틀을 작성한다.
```
dbSendQuery(con,
            "CREATE TABLE E_db (
              year TEXT,
              sido TEXT,
              gender TEXT,
              start_yr TEXT,
              start_mn TEXT)")
```
    - **dbListTables(con)**로 테이블리스트를 확인한다.
    - **dbGetQuery(con, "SELECT * FROM E_db")**
- DB에 데이터를 다음과 같이 저장한다.
    - **dbWriteTable(con, name = "E_db", value = db_3, row.names = F, append = T)**
        - value는 저장할 데이터를 의미한다.
        - append=T일 경우 데이터를 아래로 붙인다.
        - **dbDisconnect(con)**시 자동으로 저장된다.
        
### dbplyr
























